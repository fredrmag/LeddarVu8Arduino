<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LeddarVu8Arduino: C:/projects/PSS-Lidar-scanner/LeddarVu8Arduino/src/LeddarVu8Arduino.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LeddarVu8Arduino
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LeddarVu8Arduino.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Arduino LeddarTechVu8 library</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">*  Copyright (C) 2017 by PSS-GEO AS</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">*</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">*  \file       LeddarVu8Arduino.h</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*  \brief      Arduino Library for the LeddarTech Vu8 SPI sensor</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">*  \author     Fredrik Magnussen</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*  \since      March 2018</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">*</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// To prevent from including library twice</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#ifndef LeddarVu8Arduino_h</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#define LeddarVu8Arduino_h</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;SPI.h&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#define LEDDAR_DEBUG 0</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#define DISTANCE_SCALE 65536</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// SPI protocol - Leddar Vu8 constants - p.37-48 in Leddar Vu8 User guide</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// Opcodes for SPI communication</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#define READ        0x0B // Read data</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#define WRITE       0x02 // Write data</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#define RDSR        0x05 // Read status register</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#define CE          0xC7 // Reset configuration</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#define WREN        0x06 // Write enabled</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define WRDIS       0x04 // Write disabled</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#define SOFTRST     0x99 // Software reset</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Memory banks for SPI communications</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#define REGMAP_CFG_DATA     0x000000  // Configuration Data                 R/W</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#define REGMAP_DEV_INFO     0x400000  // Device information and constants   Read only</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define REGMAP_DETECTIONS   0x500000  // Detection list                     Read only</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#define REGMAP_TRN_CGF      0xFFFB00  // Transaction configuration          R/W</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// REGMAP_CFG_DATA - R/W - 0x000000</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#define LEDDARVU8_DEVICE_NAME                        0x00 | REGMAP_CFG_DATA // Module name as an ASCII string          char[32]</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#define LEDDARVU8_ACCUMMULATION_EXP                  0x20 | REGMAP_CFG_DATA // Accumulation exponent: 3 =&gt; 2^3 = 8     uint8_t</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#define LEDDARVU8_OVERSSAMPLING_EXP                  0x21 | REGMAP_CFG_DATA // Oversampling exponent: 3 =&gt; 2^3 = 8     uint8_t</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#define LEDDARVU8_BASE_POINT_COUNT                   0x22 | REGMAP_CFG_DATA // Base point sample                       uint8_t</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#define LEDDARVU8_SEGMENT_ENABLE                     0x23 | REGMAP_CFG_DATA // Bit field of segment enabled            uint32_t</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#define LEDDARVU8_REF_PULSE_RATE                     0x27 | REGMAP_CFG_DATA // Aquisition rate of the reference pulse  uint32_t</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#define LEDDARVU8_YAW                                0x2B | REGMAP_CFG_DATA // Yaw angle of the module                 float -&gt; 4 bytes</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#define LEDDARVU8_PITCH                              0x2F | REGMAP_CFG_DATA // Pitch angle of the module               float</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#define LEDDARVU8_ROLL                               0x33 | REGMAP_CFG_DATA // Roll angle of the module                float</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#define LEDDARVU8_X                                  0x37 | REGMAP_CFG_DATA // X-position of the module                float</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#define LEDDARVU8_Y                                  0x3B | REGMAP_CFG_DATA // Y-position of the module                float</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#define LEDDARVU8_Z                                  0x3F | REGMAP_CFG_DATA // Z-position of the module                float</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#define LEDDARVU8_PRECISION                          0x43 | REGMAP_CFG_DATA // Precision (Smoothing):                  int8_t</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// Stabilizes the module measurements. The behavior of the smoothing algorithm can be adjusted by a value ranging from -16 to 16.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#define LEDDARVU8_PRECISION_ENABLE                   0x44 | REGMAP_CFG_DATA // Precision enabled                       uint8_t</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#define LEDDARVU8_SAT_COMP_ENABLE                    0x45 | REGMAP_CFG_DATA // Saturation compensation enabled         uint8_t</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#define LEDDARVU8_OVERSHOOT_MANAGEMENT_ENABLE        0x46 | REGMAP_CFG_DATA // Overshoot managment enabled             uint8_t</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#define LEDDARVU8_SENSITIVITY                        0x47 | REGMAP_CFG_DATA // Sensitivity (detection threshold)       int32_t</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// setting expressed in raw amplitude scale.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#define LEDDARVU8_LED_USER_CURRENT_POWER_PERCENT     0x4B | REGMAP_CFG_DATA // Light source power (0 to 100)           uint8_t</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#define LEDDARVU8_LED_USER_AUTO_POWER_ENABLE         0x4C | REGMAP_CFG_DATA // Auto light source power enabled         uint8_t</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#define LEDDARVU8_LED_USER_AUTO_FRAME_AVG            0x4D | REGMAP_CFG_DATA // Auto frame average:                     uin16_t</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// Changes the delay in the number of measurements.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// This is the responsivity of the auto light source power according to the number of frames.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#define LEDDARVU8_LED_USER_AUTO_ECHO_AVG             0x4F | REGMAP_CFG_DATA // Auto detections average:                uint8_t</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">// Number of detections for saturation acceptance (the number of detections can be saturated to avoid decreasing the light source power when using the automatic mode). This is the responsivity of the auto light source power according to the number of detections.</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#define LEDDARVU8_DEM_ENABLE                         0x50 | REGMAP_CFG_DATA // Object demerging enabled                uint8_t</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#define LEDDARVU8_ST_NOISE_REMOVAL                   0x51 | REGMAP_CFG_DATA // Static noise removal enabled            uint8_t</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// REGMAP_DEV_INFO - R - 0x400000</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#define LEDDARVU8_MODEL_PART_NUMBER                  0x0000 | REGMAP_DEV_INFO // Module part number as an ASCII string</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#define LEDDARVU8_SOFTWARE_PART_NUMBER               0x0020 | REGMAP_DEV_INFO // Software part number as an ASCII string</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#define LEDDARVU8_MODULE_SERIAL_NUMBER               0x0040 | REGMAP_DEV_INFO // Module serial number as an ASCII string</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#define LEDDARVU8_MANUFACTURER_NAME                  0x0060 | REGMAP_DEV_INFO // Manufacturer name as an ASCII string</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#define LEDDARVU8_GROUP_IDENTIFICATION_NUMBER        0x0080 | REGMAP_DEV_INFO // Group identification number as an ASCII string</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#define LEDDARVU8_BUILD_DATE                         0x00A0 | REGMAP_DEV_INFO // Build date as an ASCII string</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#define LEDDARVU8_FIRMWARE_VERSION                   0x00C0 | REGMAP_DEV_INFO // Firmware version as an ASCII string</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#define LEDDARVU8_BOOTLOADER_VERSION                 0x00E0 | REGMAP_DEV_INFO // Bootloader version as an ASCII string</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#define LEDDARVU8_ASIC_VERSION                       0x0100 | REGMAP_DEV_INFO // ASIC version as an ASCII string</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#define LEDDARVU8_FPGA_VERSION                       0x0120 | REGMAP_DEV_INFO // FPGA version as an ASCII string</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#define LEDDARVU8_MODULE_TYPE                        0x0140 | REGMAP_DEV_INFO // Module type - 0x00 Invalid device; 0x07 M16 Evaluation Kit; 0x08 IS16; 0x09 M16; 0x0A Leddar One; 0x0D Leddar Vu8;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#define LEDDARVU8_INTERNAL_USE1                      0x0142 | REGMAP_DEV_INFO // Internal Use</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#define LEDDARVU8_ACCUMULATION_EXP_MIN               0x0146 | REGMAP_DEV_INFO // Accumulation exponent min</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#define LEDDARVU8_ACCUMULATION_EXP_MAX               0x0147 | REGMAP_DEV_INFO // Accumulation exponent max</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#define LEDDARVU8_OVERSAMPLING_EXP_MIN               0x0148 | REGMAP_DEV_INFO // Oversampling exponent min</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#define LEDDARVU8_OVERSAMPLING_EXP_MAX               0x0149 | REGMAP_DEV_INFO // Oversampling exponent max</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#define LEDDARVU8_BASE_POINT_SAMPLE_MIN              0x014A | REGMAP_DEV_INFO // Base point sample min</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#define LEDDARVU8_BASE_POINT_SAMPLE_MAX              0x014B | REGMAP_DEV_INFO // Base poing sample max</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#define LEDDARVU8_NUMBER_OF_VERTICAL_SEGMENTS        0x014C | REGMAP_DEV_INFO // Number of vertical segments</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#define LEDDARVU8_NUMBER_OF_HORIZONTAL_SEGMENTS      0x014E | REGMAP_DEV_INFO // Number of horizontal segments</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#define LEDDARVU8_NUMBER_OF_REFERENCE_SEGMENTS       0x0150 | REGMAP_DEV_INFO // Number of reference segments</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#define LEDDARVU8_BASE_POINT_SAMPLE_DISTANCE         0x0152 | REGMAP_DEV_INFO // Base point sample distance</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#define LEDDARVU8_REFERENCE_SEGMENT_MASK             0x0156 | REGMAP_DEV_INFO // Reference segment mask: bit-field mask indicates the postition of the reference segments</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#define LEDDARVU8_NUMBER_OF_SAMPLE_MAX               0x015A | REGMAP_DEV_INFO // Number of sample max</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#define LEDDARVU8_INTERNAL_USE2                      0x015C | REGMAP_DEV_INFO // Internal Use</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#define LEDDARVU8_CLOCK_FREQUENCY                    0x015D | REGMAP_DEV_INFO // Clock frequency</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#define LEDDARVU8_MAX_NUMBER_OF_DETEC_PER_SEGMENT    0x0161 | REGMAP_DEV_INFO // Maximum number of detections per segment</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#define LEDDARVU8_DISTANCE_SCALE                     0x0162 | REGMAP_DEV_INFO // Distance scale</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#define LEDDARVU8_RAW_AMPLITUDE_SCALE_BIT            0x0166 | REGMAP_DEV_INFO // Raw amplitude scale bit, to which 0xd must be added (amplitude scale given in bitshift). ie raw amplitude &lt;&lt; (scale bit + 0x0d)</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#define LEDDARVU8_RAW_AMPLITUDE_SCALE                0x0167 | REGMAP_DEV_INFO // Raw amplitude scale, to which the value 8192 must be added.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#define LEDDARVU8_PRECISION_MIN                      0x016B | REGMAP_DEV_INFO // Precision min.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#define LEDDARVU8_PRECISION_MAX                      0x016D | REGMAP_DEV_INFO // Precision max.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#define LEDDARVU8_SENSITIVITY_MIN                    0x016F | REGMAP_DEV_INFO // Sensitivity min.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#define LEDDARVU8_SENSITIVITY_MAX                    0x0173 | REGMAP_DEV_INFO // Sensitivity max.</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#define LEDDARVU8_CURRENT_LIGHT_SOURCE_PWR_COUNT     0x0177 | REGMAP_DEV_INFO // Current light source power count (max 16)</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#define LEDDARVU8_AUTO_FRAME_AVG_MIN                 0x0178 | REGMAP_DEV_INFO // Auto frame average min.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#define LEDDARVU8_AUTO_FRAME_AVG_MAX                 0x017A | REGMAP_DEV_INFO // Auto frame average max.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#define LEDDARVU8_AUTO_LIGHT_SRC_PWR_PRCNT_MIN       0x017C | REGMAP_DEV_INFO // Auto light source power percent min.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#define LEDDARVU8_AUTO_LIGHT_SRC_PWR_PRCNT_MAX       0x017D | REGMAP_DEV_INFO // Auto light source power percent max.</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#define LEDDARVU8_AUTO_DETECTION_AVG_MIN             0x017E | REGMAP_DEV_INFO // Auto detections average min.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#define LEDDARVU8_AUTO_DETECTION_AVG_MAX             0x017F | REGMAP_DEV_INFO // Auto detections average max.</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#define LEDDARVU8_STATIC_NOISE_CALIBRATION_SOURCE    0x0180 | REGMAP_DEV_INFO // Static noise calibration source:: 0 - By end-user; 1 - By factory</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#define LEDDARVU8_CPU_LOAD_SCALE                     0x0181 | REGMAP_DEV_INFO // CPU load scale</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#define LEDDARVU8_TEMPERATURE_SCALE                  0x0185 | REGMAP_DEV_INFO // Temperature scale</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">// REGMAP_DETECTIONS - R - 0x500000</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#define LEDDARVU8_TIMESTAMP                          0x00 | REGMAP_DETECTIONS // Timestamp: in ms since power up</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#define LEDDARVU8_NUMBER_OF_DTECTIONS                0x04 | REGMAP_DETECTIONS // Number of detections (N)</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#define LEDDARVU8_PERCENT_OF_LIGHT_SRC_PWR           0x06 | REGMAP_DETECTIONS // Current percentage of light source power</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#define LEDDARVU8_ACQUISITION_OPTIONS                0x08 | REGMAP_DETECTIONS // Acquisition options</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#define LEDDARVU8_START_OF_DETECTION_LIST_ARRAYS     0x0C | REGMAP_DETECTIONS // Start of detection list array length: N*12 bytes</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// REGMAP_TRN_CGF - R/W - 0xFFFB00</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#define LEDDARVU8_SECURE_TRANSACTION_ENABLED_FLAGS   0x00 | REGMAP_TRN_CGF // Secure-transaction enabled flags:</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">//1 = Enables the CRC calculation and validation on any transaction. This flag is enabled by default.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">//0 = No CRC validation. The CRC field is still required in SPI protocol but can be set to any value.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#define LEDDARVU8_TRANSACTION_MODED                  0x01 | REGMAP_TRN_CGF // Transaction modes:</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">// 0 = Free run. The READY pin is asserted on each ready detection frame. The host must be able to read data on time.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">// 1 = Blocking read. On the READY pin assertion, host must read all data from traces or detections bank (data transaction control source configuration) to continue acquisition.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">// 2 = Partial blocking read. On the READY pin assertion, host can read all data from traces of the detection bank and the acquisition is still running. Possible loss of detection frames if the host reading data is very long.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#define LEDDARVU8_CRC_OF_THE_LAST_TRANSACTION        0x02 | REGMAP_TRN_CGF // CRC of the last transaction</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#define LEDDARVU8_INFORMATION_LAST_TRANSACTION       0x04 | REGMAP_TRN_CGF // Bit-field information of last transactions:</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">//All bits to 0: No transaction error</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">// Bit-0: Access right violation</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">// Bit-1: Invalid address</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">// Bit-2: Command not found</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">// Bit-3: Write disabled</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">// Bit-4: CRC failed</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">// Bit-5: Command execution error</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">// Bit-6: Invalid packet</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#define LEDDARVU8_DATA_TRANSACTION_CONTROL_SOURCE    0x06 | REGMAP_TRN_CGF // Data transaction control source:</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">// 0 = On trace</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">// 1 = On detections</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">// This register determines which data type will control the READY pin and manage the transaction mode.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">// Error codes</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#define ERROR_LEDDAR_CRC 1</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">#define ERROR_LEDDAR_NO_RESPONSE 2</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="class_leddar_vu8_arduino.html">  152</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_leddar_vu8_arduino.html">LeddarVu8Arduino</a> {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  uint8_t <a class="code" href="class_leddar_vu8_arduino.html#a46a864dae095a57d34b176dfd9abf545">begin</a>(uint8_t csPin);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  byte <a class="code" href="class_leddar_vu8_arduino.html#a3a77c9d0af408c67032399ce0cb07345">extractByte</a>(uint32_t number, <span class="keywordtype">int</span> place);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  uint8_t * <a class="code" href="class_leddar_vu8_arduino.html#aff7c737cddf3bd782e2562ac2a51b177">leddarCommand</a>(uint8_t opcode, uint32_t address, <span class="keywordtype">size_t</span> dataSize);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  uint8_t <a class="code" href="class_leddar_vu8_arduino.html#a183db757a93e4f0023ee131a93786ddf">readRawEchoes</a>(uint32_t* distances, uint32_t* amplitudes);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  uint8_t <a class="code" href="class_leddar_vu8_arduino.html#af5bb87fe4080c6dce4ce533ddc690399">readEchoes</a>(<span class="keywordtype">float</span>* distances, <span class="keywordtype">float</span>* amplitudes);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="class_leddar_vu8_arduino.html#a475b76a6b90c31a0029b5d6d179302f7">checkCRC</a>(uint8_t* bufSend, uint8_t* bufReceive,<span class="keywordtype">size_t</span> size);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  uint32_t <a class="code" href="class_leddar_vu8_arduino.html#a8ee04f2e54927e69553f0415e2350f06">combineBytes</a>(uint8_t* buf,<span class="keywordtype">size_t</span> n);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// SPI</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="class_leddar_vu8_arduino.html#a7acc1c7227f3a7bb121997dfb7ace42b">spiStart</a>();</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_leddar_vu8_arduino.html#a63ac2511b7ed73db8ea34fdf06e48d7a">spiStop</a>();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  SPISettings m_spiSettings;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  uint8_t   m_csPin;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordtype">bool</span>      m_spiActive;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// These functions are taken from the Arduino SD card library</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">/* Arduino SdCard Library</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">  * Copyright (C) 2016 by William Greiman</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  * Modified by PSS-GEO, 2018</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordtype">void</span> spiBegin(uint8_t csPin);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">void</span> spiSetSpiSettings(SPISettings settings);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">void</span> spiActivate();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">void</span> spiDeactivate();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  uint8_t spiReceive();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  uint8_t spiReceive(uint8_t* buf, <span class="keywordtype">size_t</span> n);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordtype">void</span> spiSend(uint8_t data);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">void</span> spiSend(<span class="keyword">const</span> uint8_t* buf, <span class="keywordtype">size_t</span> n);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">void</span> spiSelect();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">void</span> spiUnselect();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;};</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="class_leddar_vu8_arduino_html_af5bb87fe4080c6dce4ce533ddc690399"><div class="ttname"><a href="class_leddar_vu8_arduino.html#af5bb87fe4080c6dce4ce533ddc690399">LeddarVu8Arduino::readEchoes</a></div><div class="ttdeci">uint8_t readEchoes(float *distances, float *amplitudes)</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:224</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html_a7acc1c7227f3a7bb121997dfb7ace42b"><div class="ttname"><a href="class_leddar_vu8_arduino.html#a7acc1c7227f3a7bb121997dfb7ace42b">LeddarVu8Arduino::spiStart</a></div><div class="ttdeci">void spiStart()</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:248</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html_a8ee04f2e54927e69553f0415e2350f06"><div class="ttname"><a href="class_leddar_vu8_arduino.html#a8ee04f2e54927e69553f0415e2350f06">LeddarVu8Arduino::combineBytes</a></div><div class="ttdeci">uint32_t combineBytes(uint8_t *buf, size_t n)</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:142</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html_a183db757a93e4f0023ee131a93786ddf"><div class="ttname"><a href="class_leddar_vu8_arduino.html#a183db757a93e4f0023ee131a93786ddf">LeddarVu8Arduino::readRawEchoes</a></div><div class="ttdeci">uint8_t readRawEchoes(uint32_t *distances, uint32_t *amplitudes)</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:160</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html_a475b76a6b90c31a0029b5d6d179302f7"><div class="ttname"><a href="class_leddar_vu8_arduino.html#a475b76a6b90c31a0029b5d6d179302f7">LeddarVu8Arduino::checkCRC</a></div><div class="ttdeci">bool checkCRC(uint8_t *bufSend, uint8_t *bufReceive, size_t size)</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:66</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html"><div class="ttname"><a href="class_leddar_vu8_arduino.html">LeddarVu8Arduino</a></div><div class="ttdoc">LeddarVu8Arduino class. </div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.h:152</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html_a63ac2511b7ed73db8ea34fdf06e48d7a"><div class="ttname"><a href="class_leddar_vu8_arduino.html#a63ac2511b7ed73db8ea34fdf06e48d7a">LeddarVu8Arduino::spiStop</a></div><div class="ttdeci">void spiStop()</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:259</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html_a3a77c9d0af408c67032399ce0cb07345"><div class="ttname"><a href="class_leddar_vu8_arduino.html#a3a77c9d0af408c67032399ce0cb07345">LeddarVu8Arduino::extractByte</a></div><div class="ttdeci">byte extractByte(uint32_t number, int place)</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:102</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html_a46a864dae095a57d34b176dfd9abf545"><div class="ttname"><a href="class_leddar_vu8_arduino.html#a46a864dae095a57d34b176dfd9abf545">LeddarVu8Arduino::begin</a></div><div class="ttdeci">uint8_t begin(uint8_t csPin)</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:19</div></div>
<div class="ttc" id="class_leddar_vu8_arduino_html_aff7c737cddf3bd782e2562ac2a51b177"><div class="ttname"><a href="class_leddar_vu8_arduino.html#aff7c737cddf3bd782e2562ac2a51b177">LeddarVu8Arduino::leddarCommand</a></div><div class="ttdeci">uint8_t * leddarCommand(uint8_t opcode, uint32_t address, size_t dataSize)</div><div class="ttdef"><b>Definition:</b> LeddarVu8Arduino.cpp:112</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
